<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
        <html lang='en' xml:lang='en' xmlns='http://www.w3.org/1999/xhtml'>
          <head>
            <title>mochiweb_skel - C0 code coverage information</title>
            <style type='text/css'>body { background-color: rgb(240, 240, 245); }</style>
            <style type='text/css'>span.marked0 {
     background-color: rgb(185, 210, 200);
     display: block;
    }
    span.marked { display: block; background-color: #ffffff; }
    span.highlight { display: block; background-color: #fff9d7; }
    span.covered { display: block; background-color: #f7f7f7 ; }
    span.uncovered { display: block; background-color: #ffebe8 ; }
    span.overview {
     border-bottom: 1px solid #E2E6EF; 
    }
    div.overview {
     border-bottom: 1px solid #E2E6EF; 
    }
    body {
     font-family: verdana, arial, helvetica;
    }
    div.footer {
     font-size: 68%;
     margin-top: 1.5em;
    }
    h1, h2, h3, h4, h5, h6 {
     margin-bottom: 0.5em;
    }
    h5 {
     margin-top: 0.5em;
    }
    .hidden {
     display: none;
    }
    div.separator {
     height: 10px;
    }
    table.percent_graph {
     height: 12px;
     border: 1px solid #E2E6EF; 
     empty-cells: show;
    }
    table.percent_graph td.covered {
     height: 10px;
     background: #00f000;
    }
    table.percent_graph td.uncovered {
     height: 10px;
     background: #e00000;
    }
    table.percent_graph td.NA {
     height: 10px;
     background: #eaeaea;
    }
    table.report {
     border-collapse: collapse;
     width: 100%;
    }
    table.report td.heading {
     background: #dcecff;
     border: 1px solid #E2E6EF; 
     font-weight: bold;
     text-align: center;
    }
    table.report td.heading:hover {
     background: #c0ffc0;
    }
    table.report td.text {
     border: 1px solid #E2E6EF; 
    }
    table.report td.value {
     text-align: right;
     border: 1px solid #E2E6EF; 
    }
    table.report tr.light {
     background-color: rgb(240, 240, 245);
    }
    table.report tr.dark {
     background-color: rgb(230, 230, 235);
    }
    </style>
          </head>
          <body>
            <h3>C0 code coverage information</h3>
            <p>Generated on 2009-02-25 00:22:45 with <a href='http://github.com/ngerakines/etap'>etap 0.3.3</a>.
            </p>            
        <table class='report'>
          <thead>
            <tr>
              <td class='heading'>Name</td>
              <td class='heading'>Total lines</td>
              <td class='heading'>Lines of code</td>
              <td class='heading'>Total coverage</td>
              <td class='heading'>Code coverage</td>
            </tr>
          </thead>
          <tbody>
            <tr class='light'>

              <td>
                <a href='mochiweb_skel_report.html'>mochiweb_skel</a>
              </td>
              <td class='value'>
                <tt>??</tt>
              </td>
              <td class='value'>
                <tt>??</tt>
              </td>
              <td class='value'>
                <tt>??</tt>
              </td>
              <td>
                <table cellspacing='0' cellpadding='0' align='right'>
                  <tr>
                    <td><tt>0%</tt>&nbsp;</td><td>
                      <table cellspacing='0' class='percent_graph' cellpadding='0' width='100'>
                      <tr><td class='covered' width='0' /><td class='uncovered' width='100' /></tr>
                      </table>
                    </td>
                  </tr>
                </table>
              </td>
            </tr>
          </tbody>
        </table><pre><span class="marked"><a name="line1"></a>....1 -module(mochiweb_skel).
</span><span class="marked"><a name="line2"></a>....2 -export([skelcopy/2]).
</span><span class="marked"><a name="line3"></a>....3 
</span><span class="marked"><a name="line4"></a>....4 -include_lib("kernel/include/file.hrl").
</span><span class="marked"><a name="line5"></a>....5 
</span><span class="marked"><a name="line6"></a>....6 %% External API
</span><span class="marked"><a name="line7"></a>....7 
</span><span class="marked"><a name="line8"></a>....8 skelcopy(DestDir, Name) ->
</span><span class="uncovered"><a name="line9"></a>....9     ok = ensuredir(DestDir),
</span><span class="uncovered"><a name="line10"></a>...10     LDst = case length(filename:dirname(DestDir)) of 
</span><span class="marked"><a name="line11"></a>...11                1 -> %% handle case when dirname returns "/"
</span><span class="uncovered"><a name="line12"></a>...12                    0;
</span><span class="marked"><a name="line13"></a>...13                N ->
</span><span class="uncovered"><a name="line14"></a>...14                    N + 1
</span><span class="marked"><a name="line15"></a>...15            end,
</span><span class="uncovered"><a name="line16"></a>...16     skelcopy(src(), DestDir, Name, LDst),
</span><span class="uncovered"><a name="line17"></a>...17     Mochiweb = filename:absname(resolve(filename:join(filename:dirname(code:which(?MODULE)), ".."))),
</span><span class="uncovered"><a name="line18"></a>...18     Target = filename:join([DestDir, Name, "lib", "mochiweb"]),
</span><span class="uncovered"><a name="line19"></a>...19     ok = file:make_symlink(Mochiweb,Target).
</span><span class="marked"><a name="line20"></a>...20     
</span><span class="marked"><a name="line21"></a>...21 
</span><span class="marked"><a name="line22"></a>...22 %% Internal API
</span><span class="marked"><a name="line23"></a>...23 
</span><span class="marked"><a name="line24"></a>...24 src() ->
</span><span class="uncovered"><a name="line25"></a>...25     Dir = filename:dirname(code:which(?MODULE)),
</span><span class="uncovered"><a name="line26"></a>...26     filename:join(Dir, "../priv/skel").
</span><span class="marked"><a name="line27"></a>...27 
</span><span class="marked"><a name="line28"></a>...28 skel() ->
</span><span class="uncovered"><a name="line29"></a>...29     "skel".
</span><span class="marked"><a name="line30"></a>...30 
</span><span class="marked"><a name="line31"></a>...31 skelcopy(Src, DestDir, Name, LDst) ->
</span><span class="uncovered"><a name="line32"></a>...32     {ok, Dest, _} = regexp:gsub(filename:basename(Src), skel(), Name),
</span><span class="uncovered"><a name="line33"></a>...33     case file:read_file_info(Src) of
</span><span class="marked"><a name="line34"></a>...34         {ok, #file_info{type=directory, mode=Mode}} ->
</span><span class="uncovered"><a name="line35"></a>...35             Dir = DestDir ++ "/" ++ Dest,
</span><span class="uncovered"><a name="line36"></a>...36             EDst = lists:nthtail(LDst, Dir),
</span><span class="uncovered"><a name="line37"></a>...37             ok = ensuredir(Dir),
</span><span class="uncovered"><a name="line38"></a>...38             ok = file:write_file_info(Dir, #file_info{mode=Mode}),
</span><span class="uncovered"><a name="line39"></a>...39             {ok, Files} = file:list_dir(Src),
</span><span class="uncovered"><a name="line40"></a>...40             io:format("~s/~n", [EDst]),
</span><span class="uncovered"><a name="line41"></a>...41             lists:foreach(fun ("." ++ _) -> ok;
</span><span class="marked"><a name="line42"></a>...42                               (F) ->
</span><span class="uncovered"><a name="line43"></a>...43                                   skelcopy(filename:join(Src, F), 
</span><span class="marked"><a name="line44"></a>...44                                            Dir,
</span><span class="marked"><a name="line45"></a>...45                                            Name,
</span><span class="marked"><a name="line46"></a>...46                                            LDst)
</span><span class="marked"><a name="line47"></a>...47                           end,
</span><span class="marked"><a name="line48"></a>...48                           Files),
</span><span class="uncovered"><a name="line49"></a>...49             ok;
</span><span class="marked"><a name="line50"></a>...50         {ok, #file_info{type=regular, mode=Mode}} ->
</span><span class="uncovered"><a name="line51"></a>...51             OutFile = filename:join(DestDir, Dest),
</span><span class="uncovered"><a name="line52"></a>...52             {ok, B} = file:read_file(Src),
</span><span class="uncovered"><a name="line53"></a>...53             {ok, S, _} = regexp:gsub(binary_to_list(B), skel(), Name),
</span><span class="uncovered"><a name="line54"></a>...54             ok = file:write_file(OutFile, list_to_binary(S)),
</span><span class="uncovered"><a name="line55"></a>...55             ok = file:write_file_info(OutFile, #file_info{mode=Mode}),
</span><span class="uncovered"><a name="line56"></a>...56             io:format("    ~s~n", [filename:basename(Src)]),
</span><span class="uncovered"><a name="line57"></a>...57             ok;
</span><span class="marked"><a name="line58"></a>...58         {ok, _} ->
</span><span class="uncovered"><a name="line59"></a>...59             io:format("ignored source file: ~p~n", [Src]),
</span><span class="uncovered"><a name="line60"></a>...60             ok
</span><span class="marked"><a name="line61"></a>...61     end.
</span><span class="marked"><a name="line62"></a>...62 
</span><span class="marked"><a name="line63"></a>...63 ensuredir(Dir) ->
</span><span class="uncovered"><a name="line64"></a>...64     case file:make_dir(Dir) of
</span><span class="marked"><a name="line65"></a>...65         ok ->
</span><span class="uncovered"><a name="line66"></a>...66             ok;
</span><span class="marked"><a name="line67"></a>...67         {error, eexist} ->
</span><span class="uncovered"><a name="line68"></a>...68             ok;
</span><span class="marked"><a name="line69"></a>...69         E ->
</span><span class="uncovered"><a name="line70"></a>...70             E
</span><span class="marked"><a name="line71"></a>...71     end.
</span><span class="marked"><a name="line72"></a>...72 
</span><span class="marked"><a name="line73"></a>...73 resolve(Path) ->
</span><span class="uncovered"><a name="line74"></a>...74     filename:join(resolve(filename:split(Path), [])).
</span><span class="marked"><a name="line75"></a>...75 
</span><span class="marked"><a name="line76"></a>...76 resolve([], Acc) ->
</span><span class="uncovered"><a name="line77"></a>...77     lists:reverse(Acc);
</span><span class="marked"><a name="line78"></a>...78 resolve(["." | Rest], Acc) ->
</span><span class="uncovered"><a name="line79"></a>...79     resolve(Rest, Acc);
</span><span class="marked"><a name="line80"></a>...80 resolve([".." | Rest], [_ | Acc]) ->
</span><span class="uncovered"><a name="line81"></a>...81     resolve(Rest, Acc);
</span><span class="marked"><a name="line82"></a>...82 resolve([".." | Rest], []) ->
</span><span class="uncovered"><a name="line83"></a>...83     resolve(Rest, []);
</span><span class="marked"><a name="line84"></a>...84 resolve([This | Rest], Acc) ->
</span><span class="uncovered"><a name="line85"></a>...85     resolve(Rest, [This | Acc]).
</span></pre><hr /><p>Generated using <a href='http://github.com/ngerakines/etap'>etap 0.3.3</a>.</p>
          </body>
        </html>
    